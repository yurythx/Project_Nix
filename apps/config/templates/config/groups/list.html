{% extends 'config/base_config_page.html' %}
{% load config_extras %}

{% block config_title %}Gerenciar Grupos{% endblock %}
{% block page_icon %}<i class="fas fa-layer-group me-2"></i>{% endblock %}
{% block page_title %}Gerenciar Grupos{% endblock %}
{% block page_actions %}
<a href="{% url 'config:group_create' %}" class="config-btn config-btn-primary">
    <i class="fas fa-plus config-icon"></i>Novo Grupo
</a>
{% endblock %}

{% block page_content %}
<div class="config-content-card">
    <div class="config-content-body">
        <div class="config-table-responsive config-table-desktop">
            <table class="config-table">
                <thead class="config-table-header">
                    <tr>
                        <th scope="col"><i class="fas fa-layer-group"></i> Nome</th>
                        <th scope="col"><i class="fas fa-users"></i> Membros</th>
                        <th scope="col"><i class="fas fa-shield-alt"></i> Permissões</th>
                        <th scope="col"><i class="fas fa-calendar"></i> Criado em</th>
                        <th scope="col"><i class="fas fa-cogs"></i> Ações</th>
                    </tr>
                </thead>
                <tbody class="config-table-body">
                {% for group in groups %}
                    <tr class="config-table-row">
                        <td class="config-table-cell">
                            <div class="config-table-user-info">
                                <div class="config-table-avatar">
                                    <div class="config-avatar config-avatar-primary">
                                        <i class="fas fa-layer-group"></i>
                                    </div>
                                </div>
                                <div class="config-table-user-details">
                                    <div class="config-table-user-name">{{ group.name }}</div>
                                    <small class="config-table-user-meta">{{ group.description|default:"Sem descrição" }}</small>
                                </div>
                            </div>
                        </td>
                        <td class="config-table-cell">
                            <span class="config-badge config-badge-info">{{ group.user_set.count }} usuário{{ group.user_set.count|pluralize:"s" }}</span>
                        </td>
                        <td class="config-table-cell">
                            <span class="config-badge config-badge-secondary">{{ group.permissions.count }} permissão{{ group.permissions.count|pluralize:"ões" }}</span>
                        </td>
                        <td class="config-table-cell">{{ group.created_at|date:"d/m/Y"|default:"—" }}</td>
                        <td class="config-table-cell">
                            <div class="config-table-actions">
                                <a href="{% url 'config:group_detail' group.slug %}" class="config-btn config-btn-sm config-btn-outline-info" title="Detalhes">
                                    <i class="fas fa-eye"></i>
                                </a>
                                <a href="{% url 'config:group_update' group.slug %}" class="config-btn config-btn-sm config-btn-outline-primary" title="Editar">
                                    <i class="fas fa-edit"></i>
                                </a>
                                <a href="{% url 'config:group_delete' group.slug %}" class="config-btn config-btn-sm config-btn-outline-danger" title="Deletar">
                                    <i class="fas fa-trash"></i>
                                </a>
                            </div>
                        </td>
                    </tr>
                {% empty %}
                    <tr class="config-table-row"><td colspan="5" class="config-table-cell config-table-empty">Nenhum grupo encontrado.</td></tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
        
        <!-- Layout responsivo para mobile -->
        <div class="config-table-mobile">
            {% for group in groups %}
            <div class="config-mobile-card">
                <div class="config-mobile-card-body">
                    <div class="config-mobile-card-header">
                        <div class="config-mobile-card-avatar">
                            <div class="config-avatar config-avatar-primary">
                                <i class="fas fa-layer-group"></i>
                            </div>
                        </div>
                        <div class="config-mobile-card-info">
                            <div class="config-mobile-card-title">{{ group.name }}</div>
                            <small class="config-mobile-card-meta">{{ group.description|default:"Sem descrição" }}</small>
                        </div>
                    </div>
                    <div class="config-mobile-card-badges">
                        <span class="config-badge config-badge-info">{{ group.user_set.count }} usuário{{ group.user_set.count|pluralize:"s" }}</span>
                        <span class="config-badge config-badge-secondary">{{ group.permissions.count }} permissão{{ group.permissions.count|pluralize:"ões" }}</span>
                    </div>
                    <div class="config-mobile-card-date">
                        Criado em: {{ group.created_at|date:"d/m/Y"|default:"—" }}
                    </div>
                    <div class="config-mobile-card-actions">
                        <a href="{% url 'config:group_detail' group.slug %}" class="config-btn config-btn-sm config-btn-outline-info" title="Detalhes">
                            <i class="fas fa-eye"></i>
                        </a>
                        <a href="{% url 'config:group_update' group.slug %}" class="config-btn config-btn-sm config-btn-outline-primary" title="Editar">
                            <i class="fas fa-edit"></i>
                        </a>
                        <a href="{% url 'config:group_delete' group.slug %}" class="config-btn config-btn-sm config-btn-outline-danger" title="Deletar">
                            <i class="fas fa-trash"></i>
                        </a>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="config-table-empty">Nenhum grupo encontrado.</div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}