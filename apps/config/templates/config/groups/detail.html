{% extends 'config/base_config_page.html' %}
{% load config_extras %}

{% block config_title %}Detalhes do Grupo{% endblock %}
{% block page_icon %}<i class="fas fa-layer-group me-2"></i>{% endblock %}
{% block page_title %}{{ group.name }}{% endblock %}
{% block page_actions %}
<a href="{% url 'config:group_update' group.slug %}" class="config-btn config-btn-primary">
    <i class="fas fa-edit"></i>
    Editar
</a>
<a href="{% url 'config:group_delete' group.slug %}" class="config-btn config-btn-danger">
    <i class="fas fa-trash"></i>
    Deletar
</a>
{% endblock %}

{% block page_content %}
<div class="config-grid">
    <div class="config-grid-main">
        <div class="config-content-card">
            <div class="config-content-header">
                <h2 class="config-content-title">
                    <i class="fas fa-info-circle"></i>
                    Informações do Grupo
                </h2>
            </div>
            <div class="config-content-body">
                <div class="config-info-list">
                    <div class="config-info-item">
                        <span class="config-info-label">Nome:</span>
                        <span class="config-info-value">{{ group.name }}</span>
                    </div>
                    <div class="config-info-item">
                        <span class="config-info-label">Slug:</span>
                        <span class="config-info-value"><code>{{ group.slug }}</code></span>
                    </div>
                    <div class="config-info-item">
                        <span class="config-info-label">Descrição:</span>
                        <span class="config-info-value">{{ group.description|default:"Sem descrição" }}</span>
                    </div>
                    <div class="config-info-item">
                        <span class="config-info-label">Criado em:</span>
                        <span class="config-info-value">{{ group.created_at|date:"d/m/Y H:i" }}</span>
                    </div>
                    <div class="config-info-item">
                        <span class="config-info-label">Última atualização:</span>
                        <span class="config-info-value">{{ group.updated_at|date:"d/m/Y H:i" }}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Membros do Grupo -->
        <div class="config-content-card">
            <div class="config-content-header">
                <h2 class="config-content-title">
                    <i class="fas fa-users"></i>
                    Membros do Grupo
                </h2>
            </div>
            <div class="config-content-body">
                {% if group.user_set.all %}
                    <div class="config-table-responsive">
                        <table class="config-table">
                            <thead class="config-table-header">
                                <tr class="config-table-row">
                                    <th class="config-table-cell">Usuário</th>
                                    <th class="config-table-cell">Email</th>
                                    <th class="config-table-cell">Status</th>
                                </tr>
                            </thead>
                            <tbody class="config-table-body">
                                {% for user in group.user_set.all %}
                                <tr class="config-table-row">
                                    <td class="config-table-cell">
                                        <div class="config-user-info">
                                            <div class="config-user-avatar">
                                                <i class="fas fa-user"></i>
                                            </div>
                                            <div class="config-user-details">
                                                <div class="config-user-name">{{ user.get_full_name|default:user.username }}</div>
                                                <div class="config-user-username">@{{ user.username }}</div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="config-table-cell">{{ user.email }}</td>
                                    <td class="config-table-cell">
                                        {% if user.is_active %}
                                            <span class="config-badge config-badge-success">Ativo</span>
                                        {% else %}
                                            <span class="config-badge config-badge-danger">Inativo</span>
                                        {% endif %}
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <div class="config-empty-state">
                        <i class="fas fa-users"></i>
                        <p>Nenhum usuário neste grupo.</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Sidebar -->
    <div class="config-grid-sidebar">
        <!-- Estatísticas -->
        <div class="config-content-card">
            <div class="config-content-header">
                <h3 class="config-content-title">
                    <i class="fas fa-chart-bar"></i>
                    Estatísticas
                </h3>
            </div>
            <div class="config-content-body">
                <div class="config-stats-grid">
                    <div class="config-stat-item">
                        <div class="config-stat-value config-text-primary">{{ group.user_set.count }}</div>
                        <div class="config-stat-label">Membros</div>
                    </div>
                    <div class="config-stat-item">
                        <div class="config-stat-value config-text-success">{{ group.permissions.count }}</div>
                        <div class="config-stat-label">Permissões</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ações Rápidas -->
        <div class="config-content-card">
            <div class="config-content-header">
                <h3 class="config-content-title">
                    <i class="fas fa-bolt"></i>
                    Ações Rápidas
                </h3>
            </div>
            <div class="config-content-body">
                <div class="config-action-list">
                    <a href="{% url 'config:group_update' group.slug %}" class="config-btn config-btn-primary config-btn-block">
                        <i class="fas fa-edit"></i>
                        Editar Grupo
                    </a>
                    <a href="{% url 'config:group_list' %}" class="config-btn config-btn-secondary config-btn-block">
                        <i class="fas fa-list"></i>
                        Ver Todos os Grupos
                    </a>
                </div>
            </div>
        </div>

        <!-- Permissões -->
        <div class="config-content-card">
            <div class="config-content-header">
                <h3 class="config-content-title">
                    <i class="fas fa-shield-alt"></i>
                    Permissões
                </h3>
            </div>
            <div class="config-content-body">
                {% if group.permissions.all %}
                    <div class="config-badge-list">
                        {% for permission in group.permissions.all %}
                            <span class="config-badge config-badge-info">{{ permission.name }}</span>
                        {% endfor %}
                    </div>
                {% else %}
                    <p class="config-text-muted">Nenhuma permissão atribuída.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}